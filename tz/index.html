<!DOCTYPE html>
<html>
  <head>
    <title>חישוב ספרת ביקורת של מספר תעודה זהות ישראלי</title>
    <meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta property="og:type" content="website" />
<meta property="og:url" content="rb077858.github.io/tz" />
<meta property="og:title" content="מחולל מספרי תעודות זהות" />
<meta property="og:description" content="עם כלי חינמי זה תוכלו ליצור אינסוף של מספרי תעודות זהות ישראליים, ובחינם לגמרי!" />
<meta property="og:image" content="https://rb077858.github.io/tz/tz.jpg" />

    <style>
    :root { direction: rtl; }
    input { direction: ltr; }
	#explain { display: none; }
	#explain[name="explain"] { display: block !important; }
	
	@media (max-width:641px) {
		body { font-size: 13pt; }
		input { display: block; font-size: 16pt; margin: .2em; padding: .3em; border: solid gray 2px; border-radius: 5px; }
		button { font-size: 13pt; padding: .5em 2em; }
	}
	</style>
  </head>
  <body>
  
  <h1>חישוב ספרת ביקורת של מספר תעודת זהות ישראלי</h1>
  
  <p>
  כדי להמציא מספר תעודת זהות ישראלית חוקית, מלאו 8 ספרות בטופס להלן. ספרת הביקורת תופיע באופן אוטומטי.
  </p>

  <h3>הקש מספר תעודת זהות</h3>
  <p>
  <input id="number" type="number" maxwidth="9"/>
  </p>
  
  <script>
var numfield = document.getElementById('number');
numfield.addEventListener('keypress', calccode, false);

function calcCode(val) {
	var sum = 0;
	for (var i = 0; i < 8; i++) {
		var digit = parseInt(val[i]);
		if (isNaN(digit))
			return;
		var result = digit * (i % 2 == 0 ? 1 : 2);
		while (result > 0) {
			sum += result % 10;
			result = parseInt(result / 10);
		}
	}
	return (10 - (sum % 10)) % 10;
}
  
function calccode(e) {
	// filter out all key codes except numbers and specials
	var keynum = null;
	var code = e.keyCode || e.charCode;
	if (code > 30 && !e.ctrlKey) {
		keynum = code - 48;
		if (keynum < 0 || keynum > 9) {
			// not allowed
			e.preventDefault();
			return;
		}
	}
 
	if (keynum === null)
		return; // skip ctrl keys
		
	var val = this.value + '' + keynum; // don't forget to add the key that was pressed
	if (val.length < 8)
		return;
	if (val.length > 9) {
		e.preventDefault(); // don't let the user type more chars
	}
	val = val.substr(0,8); // verify we look only at the first 8 digits
	var code = calcCode(val);
	this.value = val + '' + code;
	e.preventDefault(); // don't let the browser add the pressed key, because we alread did
}

function randomID() {
	var val = (document.getElementsByName('random-id-prefix')[0] || {}).value || ''
	while (val.length < 8)
		val += '' + parseInt(Math.random() * 10);
	val += '' + calcCode(val);
	numfield.value = val;
}
  
  </script>
  
	<p>
		<input type="text" name="random-id-prefix" value="999" type="number" style="display: none">
		<button onclick="randomID()">המצא מספר אקראי</button>
	</p>

	<script>
		if (window.top == window.self)
			document.getElementById('explain').setAttribute('name', 'explain');
	</script>
  </body>
</html>
